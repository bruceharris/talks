<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Classical OO Design Patterns in JavaScript</title>

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/solarized.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Classical OO Design Patterns in JavaScript</h1>
					<h3>Case Study: The Strategy Pattern</h3>
					<p>
						<small><a href="http://bruceharris.github.io/talks/">Bruce Harris</a></small>
					</p>
				</section>

				<section>
					<img src="images/rockstar.jpg">
					<aside class="notes">
						<ul>
						  <li> Background - JS Programmer
						  <li> OOP in JS
	  				  <li> No experience static
						  <li> Bible OOD - GoF
  				  </ul>
					</aside>
				</section>
				<section data-background="images/L-2.jpg">
					<aside class="notes">
						<ul>
						  <li> Didn't understand
					  	<li> Overly complicated
  				  </ul>
					</aside>
				</section>
				<section data-background="images/lego-nerd.jpg">
					<aside class="notes">
						<ul>
						  <li> Experience Java - static, classical
					  	<li> Revisited Design Patterns
					  	<li> Began to understand
					  	<li> Understood why didn't understand
  				  </ul>
					</aside>
				</section>
				<section>
					<h2>Hypothesis</h2>
					<blockquote> 
						Many of the classical object oriented design patterns were conceived 
						to work around constraints imposed by strictly typed languages without
						support for first class functions. In dynamically typed, functional
						languages, there are often simpler patterns to achieve the same objectives.
					</blockquote>
					<aside class="notes">
						<ul>
						  <li> Not necessarily better
					  	<li> Often simpler, more native
  				  </ul>
					</aside>
				</section>
				<section>
					<h2>Case Study</h2>
					<h3>Strategy Pattern</h3>
					<blockquote>
						&ldquo;Define a family of algorithms, encapsulate each one, and make
						them interchangable. Strategy lets the algorithm vary independently
						from clients that use it.&rdquo; [GoF 315]
					</blockquote>
					<aside class="notes">
						<ul>
					  	<li> Study this pattern
					  	<li> concept applicable other patterns
					  	<li> Diagram
  				  </ul>
					</aside>
				</section>
				<section>
					<h3>Strategy Pattern</h3>
					<img src="../uml/09.png">
					<aside class="notes">
						Define a family of algorithms, encapsulate each one, and make
						them interchangable (via interface). Strategy lets the algorithm vary independently from clients that use it
						<ul>
						  <li> Context has a strategy
  				  </ul>
					</aside>
				</section>
				<section>
					<h2>Case Study</h2>
					<h3>Approach</h3>
					<ol> 
						<li>Conceptual deep dive</li>
						<li>Classical style JavaScript implementation</li>
						<li>"Native style" JavaScript implementation</li>
					</ol>
					<aside class="notes">
						<ul>
						  <li> Use case for strategy
						  <li> Compare/contrast Classical/Native
  				  </ul>
					</aside>
				</section>	
				<section data-state="demoslide">	
					<div id="demoplaceholder">
				  </div>
					<aside class="notes">
						<ul>
						  <li> Imaginary application
						  <li> Various fruit
					  	<li> Appear different ways
  				  </ul>
					</aside>
				</section>	
				<section>
					<img src="../uml/01.png">
					<aside class="notes">
						<ul>
						  <li> Initial reqs
						  <li> Apple just appears
					  	<li> Banana slides in
					  	<li> Reasonable - inheritance
					  	<li> default show, override
  				  </ul>
					</aside>
				</section>
				<section>
					<img src="../uml/02.png">
					<aside class="notes">
						<ul>
						  <li> Want code easy to change
						  <li> Requirements change
						  <li> Apple rolls in
					  	<li> Still reasonable
  				  </ul>
					</aside>
				</section>
				<section>
					<img src="../uml/03.png">
					<aside class="notes">
						<ul>
						  <li> Requirements change
						  <li> New - Orange
					  	<li> Also rolls in
					  	<li> Duplication
					  	<li> Don't want change default
  				  </ul>
					</aside>
				</section>
				<section>
					<img src="../uml/04.png">
					<aside class="notes">
						<ul>
						  <li> Naive - add layer
						  <li> Beginning to smell
						  <li> Coupling behavior to class
					  	<li> Design inflexible
					  	<li> What if reqs change...
  				  </ul>
					</aside>
				</section>
				<section>
					<img src="../uml/05.png">
					<blockquote class="fragment roll-in">&ldquo;Favor object composition over class inheritance.&rdquo;
						[GoF 20]</blockquote>
					<aside class="notes">
						<ul>
						  <li> Varying hide behavior
						  <li> Doesn't fit neatly
						  <li> Where put duplicated code?
						  <li> Principle - favor...
  				  </ul>
					</aside>
				</section>
				<section>
					<img src="../uml/06.png">
					<blockquote class="fragment roll-in">&ldquo;Program to an interface, not an implementation.
						[GoF 18]</blockquote>
					<aside class="notes">
						<ul>
						  <li> Separate behavior classes
						  <li> Each fruit has instance
						  <li> Delegates to behavior class
						  <li> Code duplication
						  <li> Coupling to concrete strategy
						  <li> Principle - interface...
  				  </ul>
					</aside>
				</section>
				<section>
					<h3>Strategy Pattern</h3>
					<img src="../uml/07.png">
					<aside class="notes">
						<ul>
						  <li> Create a family of algorithms
						  <li> Encapsulate each one
						  <li> Make them interchangable
						  <li> Extend common interface
						  <li> Closer look - simplify
  				  </ul>
					</aside>
				</section>
				<section>
					<h3>Strategy Pattern</h3>
					<img src="../uml/08.png">
					<aside class="notes">
						<ul>
						  <li> Pushed show() into Superclass
						  <li> Avoid repetition	
						  <li> Client can choose strategy
						  <li> Constructor or setters
						  <li> Strategy method passed data/state
  				  </ul>
					</aside>
				</section>
				</section>
				<section data-background="#000" data-background-transition="zoom">
					<div data-markdown>
					<script type="text/template">
					## Classical Style implementation
					### Strategy Class Hierarchy – Base Class

```
// Base class with default strategy implementation
function ShowBehavior() {}
ShowBehavior.prototype.show = function($element) {
  $element.addClass('show');
}
```
					</script>
				  </div>
					<aside class="notes">
						<ul>
						  <li> Akin to Interface
						  <li> Default show method inherited
						  <li> Can be instantiated
  				  </ul>
					</aside>
				</section>
				<section data-background="#000" >
					<div data-markdown>
					  <script type="text/template">
					  ### Strategy Class Hierarchy – Subclasses

```
// SlidingLeftBehavior extends ShowBehavior
function SlidingLeftBehavior() {}
SlidingLeftBehavior.prototype = Object.create(ShowBehavior.prototype);
SlidingLeftBehavior.prototype.show = function($element) {
  $element.addClass('show slide-left');
};

// RollingRightBehavior extends ShowBehavior
function RollingRightBehavior() {}
RollingRightBehavior.prototype = Object.create(ShowBehavior.prototype);
RollingRightBehavior.prototype.show = function($element) {
  $element.addClass('show roll-right');
};
```
					  </script>
				  </div>
					<aside class="notes">
						<ul>
						  <li> Strategy subclasses
						  <li> Extend strategy base class
						  <li> Override show() - varying behavior
  				  </ul>
					</aside>
				</section>
				<section data-background="#000">
					<div data-markdown>
					<script type="text/template">
					### Context Class Hierarchy – Base Class

```
// abstract base class Fruit
function Fruit() {}

Fruit.prototype.initialize = function(shower) {
  if (shower) this.shower = shower;
  this.$element = $('<img src="images/' +
  			this.name + '.svg" class="fruit ' + this.name + '">');
  $('body').append(this.$element);
}
Fruit.prototype.show = function() {
  this.shower.show(this.$element);
}
Fruit.prototype.shower = new ShowBehavior();
```					

					* show method delegates to instance of strategy class
					* passes data to it so it can operate on context object
					</script>
				  </div>
					<aside class="notes">
						<ul>
						  <li> Abstract
						  <li> Initialize method -
						  <li> Share construction code
						  <li> Instantiate with Strategy
						  <li> Default strategy ShowBehavior
  				  </ul>
					</aside>
				</section>
				<section data-background="#000">
					<div data-markdown>
					<script type="text/template">
					### Context Class Hierarchy – Subclasses
```
// Banana extends Fruit
function Banana(shower) {
  this.initialize(shower);
}
Banana.prototype = Object.create(Fruit.prototype);
Banana.prototype.name = 'banana';


// Orange extends Fruit
function Orange(shower) {
  this.initialize(shower);
}
Orange.prototype = Object.create(Fruit.prototype);
Orange.prototype.name = 'orange';

// Apple extends Fruit
function Apple(shower) {
  this.initialize(shower);
}
Apple.prototype = Object.create(Fruit.prototype);
Apple.prototype.name = 'apple';
```
					</script>
				  </div>
					<aside class="notes">
						<ul>
						  <li> Subclass calls initialize
						  <li> Passes strategy
						  <li> Inherits show method, delegates
  				  </ul>
					</aside>
				</section>

				<section data-background="#000">
					<div data-markdown>
					<script type="text/template">
					### Client
```
var fruitList = [
  new Apple(),
  new Orange(new RollingRightBehavior()),
  new Banana(new SlidingLeftBehavior())
];

fruitList.forEach(function(fruit) {
  fruit.show();
});
```

					* pass instance of strategy to context constructor
					</script>
				  </div>
				</section>

				<section data-background="#000">
					<div data-markdown>
					<script type="text/template">
					## "Native Style" JavaScript Implementation
					### Strategy functions
```
function showSlidingLeft() {
  this.$element.addClass('show slide-left');
}

function showRollingRight() {
  this.$element.addClass('show roll-right');
}

function defaultShow() {
  this.$element.addClass('show');
}
```

					* no container class needed
					* no inheritance hierarchy
					* no passing in state/data to methods
					</script>
				  </div>
					<aside class="notes">
						<ul>
						  <li> real world - group in dictionary
  				  </ul>
					</aside>
				</section>

				<section data-markdown data-background="#000">
					<script type="text/template">
					### Context Class Hierarchy – Base Class
```
// abstract base class Fruit
function Fruit() {}

Fruit.prototype.initialize = function() {
  this.$element = $('<img src="images/' +
  			this.name + '.svg" class="fruit ' + this.name + '">');
  $('body').append(this.$element);
}
Fruit.prototype.show = defaultShow;
```

					* no need to pass in strategy to constructor
					* show method assigned to a stand alone function
					* direct reference rather than delegation
					* strategy function binds `this` dynamically
					</script>
				</section>

				<section data-background="#000">
					<div data-markdown>
					<script type="text/template">
					### Context Class Hierarchy – Subclasses
```
// Banana extends Fruit
function Banana() {
  this.initialize();
}
Banana.prototype = Object.create(Fruit.prototype);
Banana.prototype.name = 'banana';
// default strategy for Banana
Banana.prototype.show = showSlidingLeft;


// Orange extends Fruit
function Orange() {
  this.initialize();
}
Orange.prototype = Object.create(Fruit.prototype);
Orange.prototype.name = 'orange';


// Apple extends Fruit
function Apple() {
  this.initialize();
}
Apple.prototype = Object.create(Fruit.prototype);
Apple.prototype.name = 'apple';
```
					</script>
				  </div>
					<aside class="notes">
						<ul>
						  <li> not passing in strategy to constructor
						  <li> optionally override show for all Bananas
  				  </ul>
					</aside>
				</section>

				<section data-background="#000">
					<h3>Client</h3>
					<pre><code class="javascript" data-trim contenteditable style="font-size: 18px;">
// no need to pass strategy into constructor
var fruitList = [new Apple(), new Orange(), new Banana()];

// client can change strategies dynamically
fruitList[0].show = showRollingRight;

fruitList.forEach(function(fruit) {
  fruit.show();
});

var orange = new Orange();
// can dynamically change default strategy for entire class
Orange.prototype.show = showSlidingLeft;
orange.show()

// can dynamically use alternate strategy via call/apply
var banana = new Banana();
showRollingRight.apply(banana);
					</code></pre>
					</script>
				</section>

				<section>
					<h2>Summary</h2>
				  </h3>Primary Differences</h3>
				  <ol>
				    <li> point directly to function - no container class or delegation
			  	  <li> don't need to instantiate context with strategy
            <li> don't need to pass data to strategy algorithm, bind dynamically
          </ol>
					<aside class="notes">
						<ul>
							<li> Similar adaptations can be applied to some other GoF patterns
						</ul>
					</aside>
				</section>
  
				<section style="text-align: left;">
					<h1>Thanks</h1>
					<ul>
						<li>Working <a href="../demo/index.html">demo</a> with both styles fully implemented
						<li>Slides: <a href="http://bruceharris.github.io/talks">http://bruceharris.github.io/talks</a>
						<li>Source: <a href="https://github.com/bruceharris/talks">https://github.com/bruceharris/talks</a>
					</ul>
				</section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

    <script data-require="jquery@*" data-semver="2.1.3" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

			Reveal.addEventListener('demoslide', function() {
				var $iframe = $('<iframe src="../demo/native.html" width="1200" height="700">');
				$('#demoplaceholder').empty().append($iframe);
			});

		</script>

	</body>
</html>
